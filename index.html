<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R Client for the Civis Platform API • civis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R Client for the Civis Platform API">
<meta property="og:description" content="A convenient interface for making
  requests directly to the Civis Platform API &lt;https://www.civisanalytics.com/platform/&gt;.
  Full documentation available here &lt;https://civisanalytics.github.io/civis-r/&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">civis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/civis_ml.html">Machine Learning in R with CivisML</a>
    </li>
    <li>
      <a href="articles/civis_scripts.html">Productionizing with Civis Scripts</a>
    </li>
    <li>
      <a href="articles/concurrency.html">Making Simultaneous Calls to Platform</a>
    </li>
    <li>
      <a href="articles/data_import_and_export.html">Data Import and Export</a>
    </li>
    <li>
      <a href="articles/quick_start.html">Getting Started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/civisanalytics/civis-r/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="civis-platform-api-r-client" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#civis-platform-api-r-client" class="anchor"></a>Civis Platform API R Client</h1></div>

<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><code>civis</code> is an R package that helps analysts and developers interact with the Civis Platform. The package includes a set of tools around common workflows as well as a convenient interface to make requests directly to the Civis Platform API.</p>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<p>The full documentation is hosted <a href="https://civisanalytics.github.io/civis-r">here</a>. The fastest way to get started is with the <a href="https://civisanalytics.github.io/civis-r/articles/quick_start.html">getting started guide</a>.</p>
</div>
<div id="api-keys" class="section level2">
<h2 class="hasAnchor">
<a href="#api-keys" class="anchor"></a>API Keys</h2>
<p>Installing and using <code>civis</code> requires an API key. Instructions for creating an API key can be found <a href="https://civis.zendesk.com/hc/en-us/articles/216341583-Generating-an-API-Key">here</a>. All API keys have a set expiration date and so a new key will need to be created at least every 30 days.</p>
<p>Once you have created an API key, you will then need to add it to your <code>.Renviron</code> so the <code>civis</code> package can access it.</p>
<div id="linuxmacos" class="section level4">
<h4 class="hasAnchor">
<a href="#linuxmacos" class="anchor"></a>Linux/MacOS</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">touch</span> ~/.Renviron</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="ex">open</span> -t ~/.Renviron</a></code></pre></div>
<p>Then add the following line replacing the fake key <code>sadf8sadf9jasdf</code> with the API key from your Civis Platform Profile:</p>
<pre><code>CIVIS_API_KEY=sadf8sadf9jasdf</code></pre>
<p>After saving the <code>.Renviron</code> file, you’ll need to restart R/Rstudio.</p>
</div>
<div id="windows" class="section level4">
<h4 class="hasAnchor">
<a href="#windows" class="anchor"></a>Windows</h4>
<p>A <code>.Renviron</code> file can be created in the R user home directory, <code><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv("R_USER")</a></code>. Typically this is <code>"C:/username/Documents"</code>. Open or create <code>.Renviron</code> with <code>notepad</code> and add the key as above. Save with type <code>all files</code>, not <code>.txt</code>. Restart R/Rstudio.</p>
<p><span class="emoji" data-emoji="heavy_exclamation_mark">❗</span> You must keep your API key secret. If you use version control tools, ensure you do not commit <code>.Renviron</code> or any scripts in which you have hard-coded an API key.</p>
</div>
</div>
<div id="install" class="section level2">
<h2 class="hasAnchor">
<a href="#install" class="anchor"></a>Install</h2>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co"># Default install</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"civis"</span>)

<span class="co"># All features (including CivisML)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"civis"</span>, <span class="kw">depends</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></div>
<div id="updating" class="section level3">
<h3 class="hasAnchor">
<a href="#updating" class="anchor"></a>Updating</h3>
<p>The <code>civis</code> package can automatically generate R functions and documentation to interact with the Civis Platform when the package installs.</p>
<p>From time to time, new API functions are added. These can be obtained immediately by installing the package from source:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'civis'</span>, <span class="kw">depends</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">'source'</span>)</pre></div>
</div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><code>civis</code> includes functionality for both</p>
<ol>
<li>Making single calls to accomplish a specific task (which may involve making multiple calls to the API)</li>
<li>Making direct calls to the API</li>
</ol>
<p>Many useful tasks will require making multiple direct calls to the API. <code>civis</code> includes a number of wrapper functions to make common tasks like IO and modeling easier. For example, reading data from a table in Platform is as easy as</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">civis</span>)

<span class="co"># Read an entire table in to memory</span>
<span class="no">my_table</span> <span class="kw">&lt;-</span> <span class="st">"schema.tablename"</span>
<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/read_civis.html">read_civis</a></span>(<span class="no">my_table</span>, <span class="kw">database</span><span class="kw">=</span><span class="st">"my_database"</span>)

<span class="co"># Run a query and read the results into memory</span>
<span class="no">query</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/sql.html">sql</a></span>(<span class="st">"SELECT a, b, c FROM schema.tablename WHERE b &gt; 42"</span>)
<span class="no">df2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/read_civis.html">read_civis</a></span>(<span class="no">query</span>, <span class="kw">database</span><span class="kw">=</span><span class="st">"my_database"</span>)</pre></div>
<p><code>civis</code> includes many more functions for tasks like writing data to tables and files as well as for creating reports. For more detailed documentation, see the included vignettes:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes</a></span>(<span class="st">'civis'</span>)</pre></div>
<div id="direct-calls-to-api" class="section level3">
<h3 class="hasAnchor">
<a href="#direct-calls-to-api" class="anchor"></a>Direct calls to API</h3>
<p>Functions which make direct calls to the API are prefixed with the name of the resource that the function accesses. For example, the <code>users</code> resource encapsulates all the functionality of Platform regarding users. We can make various calls to the <code>users</code> resource to get information about ourselves and our team.</p>
<div class="sourceCode" id="cb7"><pre class="r"># Data about me
civis::users_list_me()

&lt;civis_api&gt;
List of 14
 $ id                      : int 971
 $ name                    : chr "A User"
 $ email                   : chr "a_user@example.com"
 $ username                : chr "a_user"
 $ initials                : chr "AU"
# ...</pre></div>
<div class="sourceCode" id="cb8"><pre class="r"># Data about my team
my_team &lt;- civis::users_list()
team_members &lt;- sapply(my_team, function(x) x$name)
print(team_members)

[1] "Jean-Luc Picard"      "Beverly Crusher"     "Q"</pre></div>
</div>
</div>
<div id="api-documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#api-documentation" class="anchor"></a>API Documentation</h2>
<p><a href="https://platform.civisanalytics.com/api">https://platform.civisanalytics.com/api</a></p>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>Contributions to the code are very welcome! Issues and bug reports can filed through the standard Github issue interface.</p>
<div id="git-flow" class="section level3">
<h3 class="hasAnchor">
<a href="#git-flow" class="anchor"></a>git-flow</h3>
<ol>
<li>Fork the repo, make changes in your branch.</li>
<li>Unit tests must pass, and can be run with <code><a href="https://devtools.r-lib.org//reference/test.html">devtools::test()</a></code> or <code>cmd-shift-t</code> in Rstudio.</li>
<li>New code must be backed with tests, mocking all API calls.</li>
<li>
<code>R CMD check</code> must pass, i.e. using <code><a href="https://devtools.r-lib.org//reference/check.html">devtools::check()</a></code>.</li>
<li>Make a pull request from the fork to the master branch of the main repo. In your pull request, link to the issue the pull request addresses.</li>
<li>Tag a maintainer for review. Once it has been approved, squash and merge!</li>
</ol>
<p>Adding the environment variable <code>R_CLIENT_DEV = "TRUE"</code> to <code>.Renviron</code> will prevent new API functions and documentation from being generated based on your API Key. The default generated API functions included in the package are only updated when this package releases to CRAN.</p>
</div>
<div id="integration-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#integration-tests" class="anchor"></a>Integration tests</h3>
<p>For major, potentially breaking changes, integration tests should be run with</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="bu">cd</span> tools/integration_tests</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="ex">Rscript</span> smoke_test.R</a></code></pre></div>
<p>Note, integration tests require a valid API key to run, and my be slow.</p>
</div>
<div id="authorship" class="section level3">
<h3 class="hasAnchor">
<a href="#authorship" class="anchor"></a>Authorship</h3>
<p>All contributors of code should include themselves in <code>DESCRIPTION</code> by adding the following object in the <code>Authors@R</code> section:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/person.html">person</a></span>(<span class="st">"FirstName"</span>, <span class="st">"LastName"</span>, <span class="kw">email</span> <span class="kw">=</span> <span class="st">"email@email.com"</span>, <span class="kw">role</span> <span class="kw">=</span> <span class="st">"ctb"</span>)</pre></div>
<p>This project is intended to be a safe, welcoming space for collaboration, and contributors are expected to adhere to the <a href="http://contributor-covenant.org">Contributor Covenant</a> code of conduct.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=civis">https://​cloud.r-project.org/​package=civis</a>
</li>
<li>Browse source code at <br><a href="https://github.com/civisanalytics/civis-r/">https://​github.com/​civisanalytics/​civis-r/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/civisanalytics/civis-r/issues">https://​github.com/​civisanalytics/​civis-r/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Patrick Miller <br><small class="roles"> Maintainer, author </small>  </li>
<li>Keith Ingersoll <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/civisanalytics/civis-r"><img src="https://travis-ci.org/civisanalytics/civis-r.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=civis"><img src="http://www.r-pkg.org/badges/version/civis" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Patrick Miller, Keith Ingersoll.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
