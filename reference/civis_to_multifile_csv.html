<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Split a Redshift table into multiple CSV parts on S3 — civis_to_multifile_csv • civis</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Split a Redshift table into multiple CSV parts on S3 — civis_to_multifile_csv" />
<meta property="og:description" content="Split a Redshift table into multiple CSV parts on S3 and return their
locations as file IDs and presigned S3 urls." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">civis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/civis_ml.html">Machine Learning in R with CivisML</a>
    </li>
    <li>
      <a href="../articles/civis_scripts.html">Productionizing with Civis Scripts</a>
    </li>
    <li>
      <a href="../articles/concurrency.html">Making Simultaneous Calls to Platform</a>
    </li>
    <li>
      <a href="../articles/data_import_and_export.html">Data Import and Export</a>
    </li>
    <li>
      <a href="../articles/quick_start.html">Getting Started</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/civisanalytics/civis-r/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Split a Redshift table into multiple CSV parts on S3</h1>
    <small class="dont-index">Source: <a href='https://github.com/civisanalytics/civis-r/blob/master/R/io.R'><code>R/io.R</code></a></small>
    <div class="hidden name"><code>civis_to_multifile_csv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Split a Redshift table into multiple CSV parts on S3 and return their
locations as file IDs and presigned S3 urls.</p>
    </div>

    <pre class="usage"><span class='fu'>civis_to_multifile_csv</span>(
  <span class='no'>sql</span>,
  <span class='no'>database</span>,
  <span class='kw'>job_name</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>hidden</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>include_header</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>compression</span> <span class='kw'>=</span> <span class='st'>"gzip"</span>,
  <span class='kw'>delimiter</span> <span class='kw'>=</span> <span class='st'>","</span>,
  <span class='kw'>unquoted</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>prefix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sql</th>
      <td><p>string, The SQL select string to be executed.</p></td>
    </tr>
    <tr>
      <th>database</th>
      <td><p>string, Name of database where query is run.</p></td>
    </tr>
    <tr>
      <th>job_name</th>
      <td><p>string, optional. Name to identify scripted sql job.</p></td>
    </tr>
    <tr>
      <th>hidden</th>
      <td><p>logical, Whether to hide the query in platform.</p></td>
    </tr>
    <tr>
      <th>include_header</th>
      <td><p>logical, optional. Whether to include headers as an
element in the returned list.</p></td>
    </tr>
    <tr>
      <th>compression</th>
      <td><p>string, optional, Type of compression to use, if any.
One of 'none', 'zip', or 'gzip'.</p></td>
    </tr>
    <tr>
      <th>delimiter</th>
      <td><p>string, optional. Which delimiter to use. One of
',', '\t' or '|'.</p></td>
    </tr>
    <tr>
      <th>unquoted</th>
      <td><p>logical, optional. Whether or not to quote fields.</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>string, optional. A user specified filename prefix for
the output files to have.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the items:</p><ul>
<li><p>header: column headers if 'include_header' is TRUE</p></li>
<li><p>query: the executed query</p></li>
<li><p>entries: a list containing presigned urls for each csv part</p></li>
<li><p>compression: the type of compression on each csv part</p></li>
<li><p>delimiter: the delimiter used to separate fields</p></li>
<li><p>unquoted: whether fields are quoted</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When tables are large, unloading by splitting them first is faster. When we
split a table, each Redshift compute node can dump its data into
S3 in parallel with the others. By doing so, we avoid having
all compute nodes sending the data through the leader node, which is slow.</p>
<p>This function returns a list that contains the location
of the CSV parts as file IDs and presigned S3 urls. The user can use either
the file IDs or the presigned S3 urls to download the CSV parts. The content
of the list returned by this function is similar to that of the manifest file
returned by Amazon S3 UNLOAD statements.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Download a table into multiple csv parts</span>
<span class='no'>sql</span> <span class='kw'>&lt;-</span> <span class='st'>"SELECT * FROM schema.table"</span>
<span class='no'>database</span> <span class='kw'>&lt;-</span> <span class='st'>"important_database"</span>
<span class='no'>manifest</span> <span class='kw'>&lt;-</span> <span class='fu'>civis_to_multifile_csv</span>(<span class='kw'>sql</span><span class='kw'>=</span><span class='no'>sql</span>, <span class='kw'>database</span><span class='kw'>=</span><span class='no'>database</span>)
<span class='no'>files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>manifest</span><span class='kw'>[[</span><span class='st'>"entries"</span>]], <span class='kw'>function</span>(<span class='no'>x</span>) {
  <span class='fu'><a href='download_civis.html'>download_civis</a></span>(<span class='no'>x</span>$<span class='no'>id</span>, <span class='no'>x</span>$<span class='no'>name</span>)
  <span class='no'>x</span>$<span class='no'>name</span>
})
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patrick Miller, Keith Ingersoll.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


